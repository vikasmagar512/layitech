<!DOCTYPE html>
<html lang="en">
<head>
    <title>Scan</title>
    <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
                <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
                    <style type="text/css">
                        /*
                        .navbar {
                            color: white;
                            background-color: #337ab7;
                        }*/
                        div.col-sm-3 {
                        padding-left: 0px;
                    }
                        ul#login-ul {
                        margin-top: 5px;
                        margin-right: 5px;
                    }

                        ul#login-ul li {
                        margin-right: 5px;
                    }
                        .container-fluid {
                        padding-right: 15px;
                        padding-left: 15px;
                        margin-right: 30px;
                        margin-left: 20px;
                        margin-top: 10px;
                    }
                        div.modal-body ul#user_registration li {
                        padding: 5px 0;
                    }
                        div.modal-body div.row {
                        padding-bottom: 10px;
                    }
                        div.modal-header {
                        background-color: #337ab7;
                        color: white;
                    }
                        div.modal-header button {
                        color: white;
                    }
                    </style>
                    <script>
                        function logout() {
                        document.cookie = 'user' + '=; path = /; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
                        window.location.href = "/scan/logout";
                    }
                    </script>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Web Application Vulnerability Testing</a>
        </div>

        <div class="navbar-header navbar-right">

            <form action="/scan/login" method="post" class="form-inline">
                <ul class="nav navbar-nav navbar-right" id="login-ul">
                    <li class="nav-item"><span>Username</span></li>
                    <li class="nav-item"><input type="text" name="username" value="abc@example.com" onfocus="if(this.value == 'abc@example.com') { this.value = ''; }"></li>
                    <li class="nav-item"><span>Password</span></li>
                    <li class="nav-item"><input type="password" name="password" value="password" onfocus="if(this.value == 'password') { this.value = ''; }"></li>
                    <li class="nav-item"><input type="submit" class="btn btn-primary" value="Login"></li>
                    <li class="nav-item"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newUser">Register</button></li>
                </ul>
            </form>

        </div>

    </div>
    <div class="row">
        <div class="col-sm-3 col-lg-2">
            <nav class="navbar navbar-default navbar-fixed-side">
                <!-- normal collapsible navbar markup -->

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li class="nav-item "><a href="/scan/host">Host Info</a></li>
                        <li class="nav-item" ><a href="/scan/webserver">Check HTTP Server</a></li>
                        <!--<li class="nav-item"><a href="/scan/broken_links">Check Broken Links</a></li> -->
                        <!--<li class="nav-item "><a href="/scan/valid_html">Validate HTML</a></li>-->
                        <li class="nav-item "><a href="/scan/port_scan">Port Scan</a></li>
                        <li class="nav-item "><a href="/scan/nmap_scan">Ping Sweep</a></li>
                        <li class="nav-item "><a href="/scan/cross-site-scripting">Cross-Site Scripting</a></li>
                        <li class="nav-item active"><a href="/scan/cross_site_req_forgery">Cross-Site Request Forgery</a></li>
                        <li class="nav-item "><a href="/scan/access_control">Missing Function Level Access Control</a></li>
                        <!--<li class="nav-item "><a href="/scan/vuln_scan">Blind SQL Injection</a></li>-->
                        <li class="nav-item "><a href="/scan/api_handler">API Handler</a></li>
                        <li class="nav-item "><a href="/scan/sqlmap">Run SQLMap</a></li>
                        <li class="nav-item "><a href="/scan/kali_scan">Run Other Kali Vulnerability Tools</a></li>
                        <li class="nav-item "><a href="/scan/myjobs">My Jobs</a></li>
                        <li class="nav-item"><a href="/scan/help">Help</a></li>
                    </ul>

                </div>
            </nav>
        </div>

        <div class="col-sm-9">

            <div class="form-group">



                <form action="" method="post" class="form-inline">
                    <label for="urlid" class="control-label">URL</label>
                    <input type="text" size="50" name="url" id="urlid" value="" placeholder="https://www.google.com" class="form-control">
                        <input type="hidden" name="url_id" value="" id="urlid1"/>
                        <!--<input type="checkbox" name="deep_links" id="deeplinks" value="yes">Scan Deep Links
                        <span id="span-deep-level" style="display:none">
                        <label for="deeplevel" class="control-label">Deep Level</label>
                        <input type="text" size="3" name="deep-level" id="deeplevel" value="0" placeholder="2" class="form-control">
                        </span>-->
                        <input type="hidden" name="userrole" value="no_role">
                            <input type="hidden" name="service" value="crosssite">
                                <input type="checkbox" name="login_required" id="loginrequired" value="yes" >Login Required?
                                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#mainModal" id="mainmodalbutton" style="display: none">Add Login Credentials</button>
                                    <div id="div-login-credentials" style="display:none">
                                        <ul type="none" id="param-list">
                                            <!--<li>
                                            <label for="username" class="control-label">User Name</label>
                                            <input type="text" size="20" name="username" id="user-name" value="" class="form-control">
                                            </li>
                                            <li>
                                            <label for="username" class="control-label">Password</label>
                                            <input type="text" size="20" name="password" id="user-password" value="" class="form-control">
                                            </li>
                                            <li>
                                            <label for="username" class="control-label">Form Name</label>
                                            <input type="text" size="20" name="form_name" id="form-name" value="" class="form-control">
                                            </li>
                                            <li>
                                            <label for="username" class="control-label">Form Number</label>
                                            <input type="text" size="20" name="form_name" id="form-number" value="" class="form-control">
                                            </li>
                                            </ul>
                                            </div>
                                            <div id="div-login-cookie" style="display:none">
                                              <ul type="none">
                                                <li>
                                                  <label for="cookie_name1" class="control-label">Cookie Name 1</label>
                                                  <input type="text" size="20" name="cookie_name1" id="cookie-name1" value="" class="form-control">
                                                </li>
                                                <li>
                                                  <label for="cookie_name2" class="control-label">Cookie Name 2</label>
                                                  <input type="text" size="20" name="cookie_name2" id="cookie-name2" value="" class="form-control">
                                                </li> -->
                                        </ul>
                                    </div>
                                    <input type="submit" class="btn btn-primary" value="Scan"></button>


                                </dl>
                </form>



                <!-- Main Modal -->
                <div id="mainModal" class="modal fade" role="dialog">
                    <div class="modal-dialog">

                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">Add Login Credentials</h4>
                            </div>
                            <div class="modal-body">
                                <div class="addedLogin">
                                    <ul id="addedLoginList" class="list-unstyled list-inline" style="display:none">


                                    </ul>
                                </div>
                                <div class="step 1 step1">
                                    Login Type
                                    <div class="alert alert-danger fade in" id="loginTypeError" style="display: none;">Please select login type</div>
                                    <div class="radio">
                                        <label><input type="radio" name="login_type" value="Credentials"  >Username / Password</label>
                                    </div>
                                    <div class="radio">
                                        <label><input type="radio" name="login_type" value="Cookie" >Cookie</label>
                                    </div>
                                    <div class="radio">
                                        <label><input type="radio" name="login_type" value="Selenium" >Selenium Xpath</label>
                                    </div>
                                </div>

                                <div class="step 2 step2">
                                    <div class="alert alert-danger fade in" id="successURLError" style="display: none;">Please enter valid success URL</div>
                                    URL if the user logged in successfully
                                    <input type="text" name="success_url" size="30" value="" class="form-control"/>
                                </div>
                                <div class="step 3 step3">
                                    <div id="login-param-div">
                                        <p>Add Login Parameters: ie the username and password to login to the site. </p>
                                        <p>Enter the name of the parameter in login form in the param field, Enter the value of the parameter in value field). For example if the username parameter is named username in login form, enter username in param field, and actual username value in value field.</p>
                                        <ul id="login-param-list" class="list-unstyled">
                                            <li>
                                                <label for="param1" class="control-label">Param 1</label>
                                                <input type="text" size="10" name="param1" value="" class="form-control" id="param-1">
                                                    <label for="value1" class="control-label">Value 1</label>
                                                    <input type="text" size="10" name="value1" value="" class="form-control" id="value-1">
                                            </li>
                                    </div>

                                    <div id="cookie-param-div">
                                        <ul id="cookie-param-list" class="list-unstyled">
                                            <li>
                                                <label for="cookie_name" class="control-label">Cookie </label>
                                                <input type="text" size="10" name="cookie_name1" value="" class="form-control" id="admin-cookie-name-">
                                                    <label for="admin_cookie_value" class="control-label">Value </label>
                                                    <input type="text" size="10" name="cookie_value1" value="" class="form-control" id="admin-cookie-value-">
                                                        <label for="admin_cookie_domain" class="control-label">Domain </label>
                                                        <input type="text" size="10" name="cookie_domain1" value="" class="form-control" id="admin-cookie-domain-">
                                                            <label for="admin_cookie_path" class="control-label">Path </label>
                                                            <input type="text" size="10" name="cookie_path1" value="" class="form-control" id="admin-cookie-path-">
                                            </li>


                                        </ul>

                                    </div>
                                    <div id="selenium-param-div">
                                        <ul id="selenium-param-list" class="list-unstyled">
                                            <li><label for="sel_cmd11" class="control-label">Xpath 1</label><input type="text" size="10" name="sel_cmd1" id="sel-cmd1" value="" class="form-control"></li>
                                        </ul>
                                    </div>
                                    <button type = "button" class = "btn btn-primary" id="add-param">Add More Param</button>
                                    <button type = "button" class = "btn btn-primary" id="add-param-save">Save</button>
                                    <button class="btn btn-primary" id="add-another-login" style="display:none">Add Another Login Credentials</button>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button class="action back btn-primary">Back</button>
                                <button class="action next btn-primary" id="nextButton">Next</button>
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>

                    </div>
                </div>

                <script>
                    crosssite = { currentstep: 1, limit: 4, edit_login: 0 };
                    jQuery(document).ready(function() {
                        widget      = $(".step");
                        btnnext     = $(".next");
                        btnback     = $(".back");
                        btnsubmit   = $(".submit");

                        crosssite.limit = widget.length;

                        $('#mainModal').on('hidden.bs.modal', function () {
                            widget      = $(".step");
                            widget.not(':eq(0)').hide();
                            console.log('close event');
                            //current = 1; Not Needed, otherwise back button wont work
                        })
                        // Hide buttons according to the current step
                        var hideButtons = function () {
                            console.log("Inside hide button: ", crosssite.currentstep, crosssite.limit);
                            $(".action").hide();

                            if (crosssite.currentstep < crosssite.limit) btnnext.show();
                            if (crosssite.currentstep > 1) btnback.show();
                            if (crosssite.currentstep == crosssite.limit) {
                                btnnext.hide();
                                btnsubmit.show();
                            }
                        };
                        // Next button click action
                        btnnext.click(function(){
                            console.log("Inside next button: ", crosssite.currentstep);
                            if (crosssite.currentstep) {
                                if (!canClickNext(crosssite.currentstep)) return;
                            }
                            if(crosssite.currentstep < crosssite.limit){
                                widget.show();
                                widget.not(':eq('+(crosssite.currentstep++)+')').hide();
                            }
                            hideButtons();
                        })
                        // Back button click action
                        btnback.click(function(){
                            if(crosssite.currentstep > 1){
                                crosssite.currentstep = crosssite.currentstep - 2;
                                btnnext.trigger('click');
                            }
                            console.log("Inside back button: ", crosssite.currentstep);
                            hideButtons();
                        })


                        jQuery("button#mainmodalbutton").click(function() {
                            if (!(is_valid_url(jQuery("#urlid").val()))) {
                                alert('Enter a valid URL to scan');
                                return false;
                            }
                            crosssite.currentstep = 1;
                            console.log("Current: " + crosssite.currentstep);
                            // Init buttons and UI
                            widget.not(':eq(0)').hide();
                            $(".step").eq(0).show();
                            hideButtons();
                        });
                    });

                    jQuery("#add-param-save").click(function() {
                        var hash;
                        var logincount = 1;
                        if ( jQuery("input[name='login_type']:checked").val() == 'Credentials' ) {
                            hash = jQuery("ul#login-param-list input, div.step1 input, div.step2 input, div.step3 input, input#urlid, input#urlid1, input[name=userrole], input[name=service]").serialize();
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Cookie' ) {
                            hash = jQuery("ul#cookie-param-list input, div.step1 input, div.step2 input, div.step3 input, input#urlid, input#urlid1, input[name=userrole], input[name=service]").serialize();
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Selenium' ) {
                            hash = jQuery("ul#selenium-param-list input, div.step1 input, div.step2 input, div.step3 input, input#urlid, input#urlid1, input[name=userrole], input[name=service]").serialize();
                        }

                        //store the parameters in div as hidden variables
                        if ( jQuery("input#login" + logincount + "-login_type").length == 0 ) {
                            jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-login_type', name: 'login' + logincount + '_login_type', value: jQuery("input[name='login_type']:checked").val() }).appendTo('#login' + logincount);
                        }
                        else {
                            jQuery("input#login" + logincount + "-login_type").val(jQuery("input[name='login_type']:checked").val());
                        }

                        if ( jQuery("input#login" + logincount + "-userrole").length == 0 ) {
                            jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-userrole', name: 'login' + logincount + '_userrole', value: jQuery("input[name='userrole']:checked").val() }).appendTo('#login'+ logincount);
                        }
                        else {
                            jQuery("input#login" + logincount + "-userrole").val(jQuery("input[name='userrole']:checked").val());
                        }

                        if ( jQuery("input#login" + logincount + "-success_url").length == 0 ) {
                            jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-success_url', name: 'login' + logincount + '_success_url', value: jQuery("input[name='success_url']").val() }).appendTo('#login' + logincount);
                        }
                        else {
                            jQuery("input#login" + logincount + "-success_url").val(jQuery("input[name='success_url']").val());
                        }
                        if ( jQuery("input[name='login_type']:checked").val() == 'Cookie' ) {
                            var paramcount = jQuery("ul#cookie-param-list li").length;
                            var cookieParams = new Array('cookie_name', 'cookie_value', 'cookie_domain', 'cookie_path');
                            for(var i= 1; i <= paramcount; i++) {
                                for(var j = 0; j < cookieParams.length; j++) {
                                    if ( jQuery("input#login" + logincount + "-" + cookieParams[j] + i ).length == 0 ) {
                                        jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-'+ cookieParams[j] + i, name: 'login' + logincount + '_' + cookieParams[j] + i, value: jQuery("input[name=" + cookieParams[j] + i +"]").val() }).appendTo('#login' + logincount);
                                    }
                                    else {
                                        jQuery("input#login" + logincount + "-" + cookieParams[j] + i ).val(jQuery("input[name=" + cookieParams[j] + i +"]").val());
                                    }
                                }
                            }
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Credentials' ) {
                            var paramcount = jQuery("ul#login-param-list li").length;
                            var loginParams = new Array('param', 'value');
                            for(var i= 1; i <= paramcount; i++) {
                                for(var j = 0; j < loginParams.length; j++) {
                                    if ( jQuery("input#login" + logincount + "-" + loginParams[j] + i).length == 0 ) {
                                        jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-'+ loginParams[j] + i, name: 'login' + logincount + '_' + loginParams[j] + i, value: jQuery("input[name=" + loginParams[j] + i +"]").val() }).appendTo('#login' + logincount);
                                    }
                                    else {
                                        jQuery("input#login" + logincount + "-" + loginParams[j] + i).val(jQuery("input[name=" + loginParams[j] + i +"]").val());
                                    }
                                }
                            }
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Selenium' ) {
                            var paramcount = jQuery("ul#selenium-param-list li").length;
                            for(var i= 1; i <= paramcount; i++) {
                                if ( jQuery("input#login" + logincount + "-" + "-sel_cmd" + i ).length == 0 ) {
                                    jQuery('<input>').attr({ type: 'hidden', id: 'login' + logincount + '-sel_cmd'+ i, name: 'login' + logincount + '_sel_cmd' + i, value:  jQuery("input[name=sel_cmd" + i).val() }).appendTo('#login' + logincount);
                                }
                                else {
                                    jQuery("input#login" + logincount + "-" + "-sel_cmd" + i ).val(jQuery("input[name=sel_cmd" + i).val());
                                }
                            }
                        }

                        crosssite.edit_login = 0;
                        jQuery.post("/scan/save_loginnew", hash, function(data) {
                            if ( data.success) {
                                alert('The Login Credentials are saved');
                                jQuery("input#urlid1").val(data.scan_id);
                            }
                            else {
                                alert('The Login Credentials are not saved. Please try again.');
                            }
                        });

                    });

                    function canClickNext() {
                        if ( crosssite.currentstep == 1 ) {
                            return validateLoginType();
                        }
                        else if ( crosssite.currentstep == 2 ) {
                            return validateRedirectURL();
                        }
                    }

                    function validateRedirectURL() {
                        if (is_valid_url(jQuery("input[name=success_url]").val())) {
                            $('#successURLError').hide();
                            return true;
                        }
                        else {
                            $('#successURLError').show();
                            return false;
                        }

                    }

                    function validateLoginType() {
                        if (jQuery("input[name='login_type']:checked").val()) {
                            $('#loginTypeError').hide();
                            jQuery("#login-param-div").hide();
                            jQuery("#cookie-param-div").hide();
                            jQuery("#selenium-param-div").hide();
                            if ( jQuery("input[name='login_type']:checked").val() == 'Credentials') {
                                jQuery("#login-param-div").show();
                            }
                            else if ( jQuery("input[name='login_type']:checked").val() == 'Cookie' ) {
                                jQuery("#cookie-param-div").show();
                            }
                            else if ( jQuery("input[name='login_type']:checked").val() == 'Selenium' ) {
                                jQuery("#selenium-param-div").show();
                            }
                            return true;
                        }
                        else {
                            $('#loginTypeError').show();
                            return false;
                        }
                    }



                </script>

                <script>
                    jQuery(document).ready(function() {
                        if (jQuery("input#loginrequired").is(':checked')) {
                            setParams('login1');
                        }
                    });

                    function setParams(idValue) {
                        console.log('setParams ',idValue)
                        var loginTypeValue1 = jQuery("input#"+idValue + "-login_type").val();
                        setLoginType(jQuery("input#"+idValue + "-login_type").val());
                        setUserRole(jQuery("input#"+idValue + "-userrole").val());
                        setSuccessURL(jQuery("input#"+idValue + "-success_url").val());
                        if ( loginTypeValue1 === 'Cookie' ) {
                            setCookieParams(idValue);
                        }
                        else if ( loginTypeValue1 === 'Credentials' ) {
                            setLoginParams(idValue);
                        }
                        else if ( loginTypeValue1 === 'Selenium' ) {
                            setSeleniumParams(idValue);
                        }
                        crosssite.edit_login = idValue.replace('login', '');

                    }

                    function setSeleniumParams(idValue) {
                        var selparamcount = jQuery("div#"+idValue + " input").filter('[name*="' + idValue + '_sel_cmd"]').length;
                        for(var i =1; i<= selparamcount; i++ ) {
                            if ( jQuery("ul#selenium-param-list li").length < i ) addSeleniumParams();
                            jQuery("input[name=sel_cmd" + i + "]").val(jQuery("input#" + idValue + "-sel_cmd" + i).val());
                        }
                    }

                    function addCookieParams() {
                        var paramcount = jQuery("ul#cookie-param-list li").length + 1;;
                        jQuery("ul#cookie-param-list").append('<li><label for="cookie_name' + paramcount + '1" class="control-label">Cookie ' + paramcount + '</label> <input type="text" size="10" name="cookie_name' + paramcount + '" id="cookie-name-'+paramcount+'" value="" class="form-control"> <label for="cookie_value' + paramcount + '1" class="control-label">Value ' + paramcount + '</label> <input type="text" size="10" name="cookie_value' + paramcount + '" id="cookie-value-' + paramcount + '" value="" class="form-control"> <label for="cookie_domain' + paramcount + '1" class="control-label">Domain ' + paramcount + '</label> <input type="text" size="10" name="cookie_domain' + paramcount + '" id="cookie-domain-' + paramcount + '" value="" class="form-control"> <label for="cookie_path' + paramcount + '1" class="control-label">Path ' + paramcount + '</label> <input type="text" size="10" name="cookie_path' + paramcount + '" id="cookie-path-' + paramcount + '" value="" class="form-control"> </li>');

                    }

                    function addSeleniumParams() {
                        var paramcount = jQuery("ul#selenium-param-list li").length + 1;;
                        jQuery("ul#selenium-param-list").append('<li><label for="sel_cmd' + paramcount + '1" class="control-label">Xpath ' + paramcount + '</label><input type="text" size="10" name="sel_cmd' + paramcount + '" id="sel-cmd" value="" class="form-control"></li>');
                    }

                    function addCredentialsParams() {
                        var paramcount = jQuery("ul#login-param-list li").length + 1;;
                        jQuery("ul#login-param-list").append('<li><label for="param' + paramcount + '" class="control-label">Param ' + paramcount + '</label><input type="text" size="10" name="param' + paramcount + '" value="" class="form-control" id="param-' + paramcount + '"><label for="value' + paramcount + '" class="control-label">Value ' + paramcount + '</label><input type="text" size="10" name="value' + paramcount + '" id="value-' + paramcount + '" value="" class="form-control"></li>');
                    }

                    function setLoginParams(idValue) {
                        var paramcount = jQuery("div#"+idValue + " input").filter('[name*="' + idValue + '_param"]').length;
                        var loginParams = new Array('param', 'value');
                        for(var i =1; i<= paramcount; i++ ) {
                            if ( jQuery("ul#login-param-list li").length < i ) addCredentialsParams();
                            for(var j = 0; j < loginParams.length; j++) {
                                var paramName = loginParams[j] + i;
                                var paramValue = jQuery("input#" + idValue + "-" + loginParams[j] + i).val();
                                jQuery("input[name=" + paramName + "]").val(paramValue);
                            }
                        }

                    }

                    function setCookieParams(idValue) {
                        var cookieCount = jQuery("div#"+idValue + " input").filter('[name*="' + idValue + '_cookie_name"]').length;
                        alert(cookieCount);
                        var cookieParams = new Array('cookie_name', 'cookie_value', 'cookie_domain', 'cookie_path');
                        for(var i = 1; i <= cookieCount; i++) {
                            if (jQuery("ul#cookie-param-list li").length < i ) addCookieParams();
                            for(var j = 0; j < cookieParams.length; j++) {
                                var paramName = cookieParams[j] + i;
                                var paramValue = jQuery("input#" + idValue + "-" + cookieParams[j] + i).val();
                                jQuery("input[name=" + paramName + "]").val(paramValue);
                            }
                        }
                    }


                    function setLoginType(loginTypeValue) {
                        jQuery("input:radio[name='login_type']").filter("[value="+ loginTypeValue +"]").click();
                        return true;
                    }

                    function setUserRole(userRoleValue) {
                        jQuery("input:radio[name='userrole']").filter("[value="+ userRoleValue +"]").click();
                        return true;
                    }

                    function setSuccessURL(sucessURLValue){
                        jQuery("input[name='success_url']").val(sucessURLValue);
                        return true;
                    }

                </script>

                <script>
                    jQuery(document).ready(function() {
                    var paramcount = 1;
                    jQuery("#deeplinks").change(function() {
                        if (this.checked) {
                            jQuery("#span-deep-level").show();
                            //alert('Checked');
                        }
                        else {
                            jQuery("#span-deep-level").hide();
                        }


                    });

                    if (jQuery("input#loginrequired").is(':checked')) {
                        jQuery("#mainmodalbutton").show();
                    }
                    else {
                        jQuery("#mainmodalbutton").hide();
                    }

                    jQuery("#add-param").click(function() {
                        alert('Test');
                        if ( jQuery("input[name='login_type']:checked").val() == 'Credentials' ) {
                            addCredentialsParams();
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Cookie' ) {
                            addCookieParams();
                        }
                        else if ( jQuery("input[name='login_type']:checked").val() == 'Selenium' ) {
                            addSeleniumParams();
                        }
                    });

                    jQuery("#loginrequired").change(function() {
                        if (this.checked) {
                        //jQuery("#div-login").show();
                            jQuery("#mainmodalbutton").show();
                            //alert('Checked');
                        }
                        else {
                            jQuery("#mainmodalbutton").hide();
                            jQuery("#div-login-credentials").hide();
                            jQuery("#div-login-cookie").hide();
                            //jQuery("#div-login").hide();
                        }
                    });

                    jQuery("input[type=radio][name=login_type]").change(function() {
                        if (this.value == 'Credentials' ) {
                            jQuery("#div-login-credentials").show();
                            //jQuery("#div-login-cookie").hide();
                        }
                        else {
                            jQuery("#div-login-credentials").show();
                            //jQuery("#div-login-cookie").show();
                        }
                    });

                });

                    function is_valid_url(url) {
                        return /^(http(s)?:\/\/)?(www\.)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/.test(url);
                    }

                </script>

                <script>
                    jQuery(document).ready(function() {
                    check_scan_progress();
                });

                    function check_scan_progress() {
                    var scanid = jQuery("div.broken-link-progress").attr('id');
                    scanid = scanid.replace("scan-", "");
                    jQuery.get("/scan/cross_site_progress", { scan_id: scanid }, function(response) {
                    if(response.status == 'Finished') {
                    jQuery.get("/scan/cross_site_results", { scan_id: scanid }, function(data) {
                    if(data.links) {
                    jQuery.each(data.links, function() { jQuery("#list-"+scanid).append("<li>" + this + "</li>") });
                }
                });
                }
                    else {
                    setTimeout( function() { check_scan_progress() }, 10000);
                }
                });
                }

                </script>

            </div>

        </div>
    </div>
    <div id="footer">
        <!-- Powered by <a href="http://perldancer.org/">Dancer2</a> <% dancer_version %> -->
    </div>

    <div id="newUser" class="modal fade" tabindex="-1" role="dialog" >
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Register
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </h5>
                </div>
                <form action="/scan/register" method="post" class="form-inline">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-sm-4">
                                First Name:
                            </div>
                            <div class="col-sm-4">
                                <input type="text" size="30" name="first_name">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                Last Name:
                            </div>
                            <div class="col-sm-4">
                                <input type="text" size="30" name="last_name">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                Email Address (username):
                            </div>
                            <div class="col-sm-4">
                                <input type="text" size="40" name="email_address"></li>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                Password:
                            </div>
                            <div class="col-sm-4">
                                <input size="30" name="password" type="password">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-4">
                                Retype Password:
                            </div>
                            <div class="col-sm-4">
                                <input size="30" name="password1" type="password">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Register</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <footer>
        <div class="navbar navbar-default">
            <div class="container">
                <div class="navbar-collapse collapse" id="footer-body">
                    <ul class="nav navbar-nav">
                        <li><a href="#">Browse Our Library</a></li>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Our Partners</a></li>
                        <li><a href="#">User Review</a></li>
                        <li><a href="#">Terms &amp; Conditions</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#footer-body">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <ul class="footer-bar-btns visible-xs">
                        <li><a href="#" class="btn" title="History"><i class="fa fa-2x fa-clock-o blue-text"></i></a></li>
                        <li><a href="#" class="btn" title="Favourites"><i class="fa fa-2x fa-star yellow-text"></i></a></li>
                        <li><a href="#" class="btn" title="Subscriptions"><i class="fa fa-2x fa-rss-square orange-text"></i></a></li>
                    </ul>
                </div>

            </div>
        </div>
    </footer>
</body>
</html>



